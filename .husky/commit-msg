#!/bin/zsh

{
  if ! read -r TITLE; then
    echo "π”΄ μ»¤λ°‹ μ λ©μ€ λΉ„μ–΄μμ„ μ μ—†μµλ‹λ‹¤."
    exit 1
  fi

  if [ ${#TITLE} -gt 50 ] && ! [[ "$TITLE" =~ ^(fixup|squash)! ]]; then
    echo "π”΄ μ»¤λ°‹ μ λ©μ΄ ${#TITLE}μλ΅ 50μ μ ν•μ„ μ΄κ³Όν–μµλ‹λ‹¤."
    exit 1
  fi

  if [[ "$TITLE" == *\. ]]; then
    echo "π”΄ μ»¤λ°‹ μ λ©μ€ λ§μΉ¨ν‘λ΅ λλ‚  μ μ—†μµλ‹λ‹¤."
    exit 1
  fi

  while IFS= read -r BODY; do
    if [ ${#BODY} -gt 72 ] && ! [[ "$BODY" =~ ^# ]] && ! [[ "$BODY" =~ https?:// ]]; then
      echo "π”΄ '${BODY:0:20}...'κ°€ ${#BODY}μλ΅ 72μ μ ν•μ„ μ΄κ³Όν–μµλ‹λ‹¤."
      exit 1
    fi
  done
} < "$1"

exit 0

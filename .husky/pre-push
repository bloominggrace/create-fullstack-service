#!/bin/zsh

GIT_STATUS=$(git status --porcelain)

echo "π” λ¦°νΈ κ²€μ‚¬λ¥Ό μ‹μ‘ν•©λ‹λ‹¤."

if ! LINT_LOG=$(pnpm lint 2>&1) || [ "$GIT_STATUS" != "$(git status --porcelain)" ]; then
  echo "β λ¦°νΈ κ²€μ‚¬μ— μ‹¤ν¨ν•μ—¬ μ½”λ“κ°€ λ³€κ²½λμ—μΌλ‹, ν™•μΈ ν›„ λ‹¤μ‹ μ‹λ„ν•΄μ£Όμ„Έμ”." >&2
  echo "$LINT_LOG"
  exit 1
else
  echo "β… λ¦°νΈ κ²€μ‚¬λ¥Ό ν†µκ³Όν–μµλ‹λ‹¤."
fi

echo "π” νƒ€μ… κ²€μ‚¬λ¥Ό μ‹μ‘ν•©λ‹λ‹¤."

if ! TYPE_LOG=$(pnpm type-check 2>&1); then
  echo "β νƒ€μ… κ²€μ‚¬μ— μ‹¤ν¨ν–μµλ‹λ‹¤."
  echo "$TYPE_LOG"
  exit 1
else
  echo "β… νƒ€μ… κ²€μ‚¬λ¥Ό ν†µκ³Όν–μµλ‹λ‹¤."
fi

exit 0